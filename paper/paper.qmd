---
title: "Factors influencing Total Income in the United States"
subtitle: "Research and Statistical Analysis on Factors influencing Total Income in the United States of America"
author: 
  - Wen Han Zhao
thanks: "Code and data are available at: [https://github.com/younazhao/Income-Influencing-Factors.git](https://github.com/younazhao/Income-Influencing-Factors.git)."
date: 1 December 2024
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
toc: true
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(arrow)
library(dplyr)
```

```{r}
#| include: false
#| warning: false
#| message: false

data <- read_parquet(here::here("data/02-analysis_data/analysis_data.parquet"))
```


# Introduction

Income inequality is a central concern in economic research, reflecting disparities in access to opportunities, resources, and outcomes. In the United States, total income is influenced by a variety of factors, including personal, professional, and demographic characteristics. This paper explores the relationship between total income and predictors such as marital status, sex, educational level, labor force participation, and occupation. By employing statistical modeling techniques, we aim to uncover the extent to which these variables shape income levels and contribute to broader income disparities.

The estimand of this study is the expected total income for individuals based on their social, personal and occupational characteristics. Specifically, the analysis seeks to quantify how factors such as marital status, sex, educational attainment, participation in the labor force, and occupational category predict variations in total income across the U.S. population. This includes identifying both independent and among these variables.

Preliminary results indicate that educational attainment is one of the strongest predictors of total income, with higher levels of education yielding significantly greater earnings. Marital status also plays a notable role, with married individuals generally earning more than their single counterparts. Gender disparities in income persist, with men earning more on average than women across most occupational categories. Labor force participation and occupation further highlight critical differences, as full-time workers and those in higher-skilled professions consistently report higher incomes.

Understanding the drivers of income disparities is essential for designing policies that promote economic equity and mobility. By identifying how marital status, gender, education, labor force participation, and occupation contribute to income levels, this research offers actionable insights for policymakers, employers, and educators. Addressing these disparities not only fosters greater fairness but also enhances the overall economic productivity and social cohesion of the United States.

To do this, total income was analyzed in Section 2 @sec-data. The prediction from the model has show accuracy in lower total income group. The model has shown difficulties in predicting higher total income. Section 3 @sec-model has further explanation on the Bayesian Generalized Linear Model. Section 4 @sec-results show the coefficient beta from the model. Section 5 @sec-discussion focus on the weakness of this study and further possible improvements. Lastly, Section 6 @sec-appendix contains methodology to perform a survey to collect data for Total Income.

# Data {#sec-data}

## Overview {#sec-data-overview}

The Survey of Consumer Finances (SCF), conducted in 2022 covering the period 1989 to 2022 by the Board of Governors of the Federal Reserve System of the United States [@scfdata], provides a comprehensive snapshot of household financial conditions across the nation. This dataset includes detailed information related to total income, capturing key predictors such as sex, education level, occupation category, salary income, and income from other sources. By offering rich, granular data, the SCF serves as an invaluable resource for analyzing the factors influencing income distribution and economic disparities within the United States.

## Measurement {#sec-data-measurement}

The survey contained a panel element over 2 periods. Respondents to the 1983 survey were re-interviewed in 1986 and 1989. Respondents to the 2007 survey were re-interviewed in 2009. In order to ensure the representativeness of the study, respondents are selected randomly in order to attempt families from all economic strata. 

## Outcome variables{#sec-data-outcome}

Histograph of the predicted variables, Total income.

```{r}
#| label: fig-hist
#| fig-cap: Histogram of Total Income 
#| echo: false
data$log_income <- log(data$income)
ggplot(data, aes(x = log_income)) +
  geom_histogram(binwidth = 0.5, fill = "blue", color = "black", alpha = 0.7) +
  labs(title = "Histogram of Total Income", x = "Log Income", y = "Frequency") +
  theme_minimal()
```

```{r}
#| label: fig-qq
#| fig-cap: Comparison of Income Distribution using QQ Plot
#| echo: false
#| warning: false
#| message: false

ggplot(data = data, aes(sample = log_income)) +
  geom_qq(color = "black", size = 1, alpha = 0.7) + # Adds blue points with some transparency
  geom_qq_line(color = "blue", linetype = "dashed", size = 1) + # Adds a red dashed reference line
  theme_minimal() +
  labs(
    title = "Q-Q Plot of Income",
    subtitle = "Comparison of Income Distribution to a Theoretical Normal Distribution",
    x = "Theoretical Quantiles",
    y = "Sample Quantiles"
  )

```

## Predictor variables{#sec-data-predictor}

Predictors variables selected are Age, Sex, Marital Status, Education Level, Labour Force, Work Status, and Occupation category.

```{r}
#| label: fig-pred
#| fig-cap: Relationship of Predictors variables with Total Income
#| echo: false
#| warning: false
#| message: false
# Set up the plotting area
par(mfrow = c(3, 3), mar = c(4, 4, 2, 2)) # 3 rows, 3 columns

# Scatterplot: Log Income by Age with a regression line
plot(data$Age, data$log_income, type = "p", main = "Log Income by Age", 
     xlab = "Age", ylab = "Log Income")
abline(lm(log_income ~ Age, data = data), col = "red", lwd = 2) # Add regression line

# List of variables for boxplots
boxplot_vars <- list(
  list(var = "married", title = "Marital Status"),
  list(var = "num_sex", title = "Sex"),
  list(var = "educ", title = "Education Level"),
  list(var = "lf", title = "Labour Force"),
  list(var = "num_work", title = "Work Status"),
  list(var = "num_occu", title = "Occupation")
)

# Generate boxplots in a loop
for (bp in boxplot_vars) {
  boxplot(
    log_income ~ get(bp$var, data), 
    data = data,
    main = paste("Log Income by", bp$title),
    xlab = bp$title,
    ylab = "Log Income",
    col = "lightblue",
    border = "darkblue"
  )
}

```

# Model{#sec-model}

The goal of our modelling strategy is twofold. Firstly,...

Here we briefly describe the Bayesian analysis model used to investigate... Background details and diagnostics are included in [Appendix -@sec-model-details].

## Model set-up{#sec-model-setup}

Define $y_i$ as the number of seconds that the plane remained aloft. Then $\beta_i$ is the wing width and $\gamma_i$ is the wing length, both measured in millimeters.  

\begin{align} 
y_i|\mu_i, \sigma &\sim \mbox{Normal}(\mu_i, \sigma) \\
\mu_i &= \alpha + \beta_i + \gamma_i\\
\alpha &\sim \mbox{Normal}(0, 2.5) \\
\beta &\sim \mbox{Normal}(0, 2.5) \\
\gamma &\sim \mbox{Normal}(0, 2.5) \\
\sigma &\sim \mbox{Exponential}(1)
\end{align}

We run the model in R [@citeR] using the `rstanarm` package of @rstanarm. We use the default priors from `rstanarm`.


### Model justification

We expect a positive relationship between the size of the wings and time spent aloft. In particular...

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

Our results are summarized in @tbl-modelresults.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false

library(rstanarm)

first_model <-readRDS(file = here::here("models/bayesian_model_2.rds"))
model plot
```

```{r}
#| echo: false
#| eval: true
#| label: tbl-modelresults
#| tbl-cap: "Explanatory models of flight time based on wing width and wing length"
#| warning: false

modelsummary::modelsummary(list("First model" = first_model),statistic = "mad",fmt = 2)
```




# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

Please don't use these as sub-heading labels - change them to be what your point actually is.

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 

```{r}
#| eval: true
#| echo: false
#| message: false
#| warning: false
#| label: fig-ppcheckandposteriorvsprior
#| layout-ncol: 2
#| fig-cap: "Examining how the model fits, and is affected by, the data"
#| fig-subcap: ["Posterior prediction check", "Comparing the posterior with the prior"]

#pp_check(first_model) +
#  theme_classic() +
#  theme(legend.position = "bottom")

#posterior_vs_prior(first_model) +
#  theme_minimal() +
#  scale_color_brewer(palette = "Set1") +
#  theme(legend.position = "bottom") +
#  coord_flip()
```

## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-stanareyouokay
#| fig-cap: "Checking the convergence of the MCMC algorithm"
#| fig-subcap: ["Trace plot", "Rhat plot"]
#| layout-ncol: 2

#plot(first_model, "trace")

#plot(first_model, "rhat")
```



\newpage


# References


